{
  "dungeonName":"Darklight Dungeon",
  "description":"This shadowy dungeon has lots of shadows.",
  "monsterLibrary":
  {
  	"Shadow":
  	{
  		"name":"Shadow",
  		"health": 8,
  		"might":2,
  		"defense":1,
  		"onDeath":"addToDungeonValue numShadowsKilled 1;print \"You feel a barrier weakening.\""
  	},
  	"MiniShadow":
  	{
  		"name":"Small Shadow",
  		"health":4,
  		"might":1,
  		"defense":0
  	}
  },
  "onVariableSet":
  {
  	"numShadowsKilled":"$if[{numShadowsKilled} = 3] @4 clearObstacle ShadowBarrier"
  },
  "levels":
  {
    "Ground":0,
    "Second Floor":1,
    "Basement":2
  },
  "rooms":
  [
    {
      "name":"Entryway",
      "id":1,
      "description":"A chasm divides this brightly lit room in two.",
      "lighting":1.0,
      "obstacles":
      [
        {
          "@class" : "paul.TextQuest.entities.obstacles.Chasm",
          "name": "Chasm",
          "solution": "jump",
          "blockedDirections":
          [
            "EAST"
          ]
        },
        {
          "@class" : "paul.TextQuest.entities.obstacles.SmashableObstacle",
          "name": "Barrel",
          "solution": "smash",
          "onSmash":"createMonster Skeleton"
        }
      ],
      "connectedRoomIds":
      {
        "EAST":2
      }
    },
    {
      "name":"Shadowy Crossway",
      "id":2,
      "description":"Passages lead out of this dimly lit room. One corner is completely obscured by shadow.",
      "lighting":0.5,
      "onSearch":
      {
      	"corner":"createMonster Shadow;startFight;print \"A living shadow leaps out and attacks!\""
      },
      "connectedRoomIds":
      {
        "WEST":1,
        "EAST":3,
        "NORTH":9,
        "SOUTH":5
      }
    },
    {
      "name":"Shadowy Storage",
      "id":3,
      "description":"You can't initially make out much in this room.",
      "lighting":0.5,
      "chest":
      {
        "name":"Treasure Chest",
        "locked":false,
        "contents":
        [
          {
            "name":"Treasure",
            "value":50
          },
          {
            "name":"Potion"
          }
        ]
      },
      "connectedRoomIds":
      {
        "WEST":2,
        "EAST":4
      }
    },
    {
      "name":"Shadowy Basement Access",
      "id":4,
      "description":"The stairs leading down are blocked by a shadowy barrier.",
      "lighting":0.5,
      "obstacles":
      [
        {
          "@class" : "paul.TextQuest.entities.obstacles.MagicBarrier",
          "name": "ShadowBarrier",
          "solution": "(script)",
          "onClear": "changeRoomDescription \"The stairs leading down are no longer blocked.\"",
          "displayIfCleared":false,
          "blockedDirections":
          [
            "DOWN"
          ]
        }
      ],
      "connectedRoomIds":
      {
        "WEST":3,
        "SOUTH":7,
        "DOWN":21
      }
    },
    {
      "name":"Shadowy Guardroom",
      "id":5,
      "description":"A dangerous shadow guards this room.",
      "lighting":0.5,
      "monsters":
      [
        {
          "name":"Shadow Guard",
          "health": 10,
          "might": 3,
          "defense":2,
          "onDeath": "addToDungeonValue numShadowsKilled 1;print \"You feel a barrier weakening.\""
        }
      ],
      "items":
      [
        {
          "name":"Potion"
        }
      ],
      "connectedRoomIds":
      {
        "NORTH":2,
        "EAST":6
      }
    },
    {
      "name":"Dim Closet",
      "id":6,
      "description":"There is a small table in this tiny room. Nothing else is visible.",
      "lighting":0.5,
      "items":
      [
        {
          "name":"Darklight Key",
          "darklight":true
        }
      ],
      "connectedRoomIds":
      {
        "WEST":5
      }
    },
    {
      "name":"Dim Passage",
      "id":7,
      "description":"We hope you don't take a dim view of riddles.",
      "lighting":0.5,
      "obstacles":
      [
        {
          "@class" : "paul.TextQuest.entities.obstacles.RiddleObstacle",
          "name": "Riddle",
          "solution": "shadows",
          "displayIfCleared":true,
          "riddle": "We can only live where there is light, but we die if light shines on us.",
          "blockedDirections":
          [
            "EAST"
          ]
        }
      ],
      "connectedRoomIds":
      {
        "NORTH":4,
        "EAST":8
      }
    },
    {
      "name":"Shadowy Armory",
      "id":8,
      "description":"This room appears to be completely empty.",
      "lighting":0.5,
      "chest":
      {
        "name":"Darklight Chest",
        "locked":true,
        "key":"Darklight Key",
        "darklight":true,
        "contents":
        [
          {
            "name":"Helm of Defense",
            "onPickup":"createMonster Shadow"
          }
        ]
      },
      "connectedRoomIds":
      {
        "WEST":7
      }
    },
    {
      "name":"Upper Floor Access",
      "id":9,
      "description":"Stairs lead up into blindingly bright light.",
      "lighting":0.5,
      "items":
      [
        {
          "name":"Potion"
        }
      ],
      "connectedRoomIds":
      {
        "SOUTH":2,
        "UP":11
      }
    },
    {
      "name":"2nd Floor Landing",
      "id":11,
      "description":"Bright light comes from no apparent source, reflecting off white tiles.",
      "lighting":1.0,
      "connectedRoomIds":
      {
        "DOWN":9,
        "EAST":12
      }
    },
    {
      "name":"Light Lieutenant's Office",
      "id":12,
      "description":"A shining figure stands in the middle of the room.",
      "lighting":1.0,
      "onLightingChange":
      {
        "WELL_LIT":"makeMinibossStrong",
        "PITCH_BLACK":"makeMinibossWeak"
      },
      "specialRoomActions":
      {
      	"climb":"removeTrigger specialRoomActions climb;removeTrigger onSearch ladder;addFeature Mirror;print \"You found a mirror up near the ceiling.\""
      },
      "onSearch":
      {
      	"ladder":"removeTrigger specialRoomActions climb;addFeature Mirror;print \"You found a mirror up near the ceiling.\""
      },
      "monsters":
      [
        {
          "name":"Light Lieutenant",
          "health": 25,
          "might": 2,
          "defense":1,
          "isMiniboss":true,
          "abilities":
          {
            "light":
            {
              "action":"light",
              "before":true
            }
          },
          "behavior":
          {
            "EVERY_OTHER_ROUND":"light"
          },
          "onDeath":"changeRoomDescription \"There's a light crystal in the room\""
        }
      ],
      "items":
      [
        {
          "name":"Mirror Shield",
          "onPickup":"print \"The way out is barred by a gate controlled by the Light Crystal.\";tutorial \"You'll need to clean all the mirrors in the room and then use shine.\""
        }
      ],
      "features":
      [
      	{
      		"name":"North Mirror"
      	},
      	{
      		"name":"South Mirror"
      	},
      	{
      		"name":"Light Crystal",
      		"description": "A dim crystal sits in the middle of the room."
      	},
      	{
      		"name":"Small Ladder",
      		"description": "A small ladder allows you to climb up closer to the ceiling."
      	}
      ],
      "obstacles":
      [
        {
          "@class" : "paul.TextQuest.entities.obstacles.ShinePuzzle",
          "name": "Shine Puzzle",
          "solution":"shine",
          "numMirrors":3,
          "onAttempt":"tutorial \"You have to find and clean all three mirrors first.\"",
          "displayIfCleared":true,
          "blockedDirections":
          [
            "WEST"
          ]
        }
      ],
      "connectedRoomIds":
      {
        "WEST":11
      }
    },
    {
      "name":"Basement Landing",
      "id":21,
      "lighting":0.0,
      "description":"It's pitch black down here.",
      "connectedRoomIds":
      {
        "UP":4,
        "NORTH":25,
        "SOUTH":22
      }
    },
    {
      "name":"Dark Access Room",
      "id":22,
      "lighting":0.0,
      "description":"There's a puzzle here? Eventually.",
      "features":
      [
      	{
      		"name":"Large Mirror"
      	},
      	{
      		"name":"Big Switch",
      		"description":"A big switch. Try flicking it."
      	}
      ],
      "specialRoomActions":
      {
      	"flick":"removeTrigger specialRoomActions flick;addFeature Mirror"
      },
      "obstacles":
      [
        {
          "@class" : "paul.TextQuest.entities.obstacles.ShinePuzzle",
          "name": "Shine Puzzle",
          "solution":"shine",
          "numMirrors":3,
          "onAttempt":"tutorial \"You have to find and clean all three mirrors first.\"",
          "displayIfCleared":false,
          "blockedDirections":
          [
            "EAST"
          ]
        },
        {
          "@class" : "paul.TextQuest.entities.obstacles.SmashableObstacle",
          "name": "Barrel",
          "solution": "smash",
          "onSmash":"addFeature Mirror;print \"Smashing the barrel reveals a mirror hidden behind it.\""
        }
      ],
      "connectedRoomIds":
      {
        "NORTH":21,
        "EAST":23
      }
    },
    {
      "name":"Shadow Restoration Room",
      "id":23,
      "lighting":0.1,
      "description":"It's not quite pitch black in here.",
      "features":
      [
        {
          "name":"Darklight Healing Fountain",
          "darklight":true
        }
      ],
      "onLightingChange":
      {
        "WELL_LIT":"removeTrigger specialRoomActions drink",
        "PITCH_BLACK":"addTrigger specialRoomActions drink heal 10"
      },
      "onHeroLeave":
      {
        "EAST":
        {
          "action":"bump fountain",
          "stops":true
        }
      },
      "connectedRoomIds":
      {
        "WEST":22,
        "EAST":24
      }
    },
    {
      "name":"Shadow Captain's Lair",
      "id":24,
      "lighting":0.0,
      "description":"Lair of the boss",
      "bossFightFileLocation":"shadow_captain.json",
      "connectedRoomIds":
      {
        "WEST":23
      }
    },
    {
      "name":"Shadowsplitter Research",
      "id":25,
      "lighting":0.0,
      "monsters":
      [
      	{
          "name":"Massive Shadow",
          "health": 15,
          "might": 1,
          "defense":2,
          "onDeath": "createMonster MiniShadow;createMonster MiniShadow;print \"The massive shadow splits in two!\""
        }
      ],
      "connectedRoomIds":
      {
        "SOUTH":21,
        "EAST":26
      }
    },
    {
      "name":"Shadow Training",
      "id":26,
      "lighting":0.0,
      "description":"There's a large pool of shadow in the middle of the room.",
      "onSearch":
      {
      	"pool":"teachSpell shadow;explode 5"
      },
      "connectedRoomIds":
      {
        "WEST":25
      }
    }
  ]
}